<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>非正常博士研究中心 鲜蔬杯#2 计算器</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin-top: 20px;
            background-color: #f0f0f0;
        }
        .calculator {
            display: inline-block;
            padding: 20px;
            border-radius: 10px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            width: 90%;
            max-width: 600px;
        }
        h1, h2 {
            color: #333;
        }
        .section {
            margin: 20px 0;
        }
        .section select, .section input {
            padding: 10px;
            margin: 10px 0;
            font-size: 16px;
        }
        .section label {
            font-size: 16px;
            margin-right: 10px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            margin-top: 20px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 5px;
        }
        button:hover {
            background-color: #218838;
        }
        #result, #details {
            font-size: 20px;
            margin-top: 20px;
            text-align: left;
        }
    </style>
</head>
<body>
    <div class="calculator">
        <h1>非正常博士研究中心 鲜蔬杯#2 计算器</h1>

        <!-- 第一部分：通过层数分 -->
        <div class="section">
            <h2>通过层数分</h2>
            <label for="floor">选择层数：</label>
            <select id="floor">
                <option value="1">1层</option>
                <option value="2">2层</option>
                <option value="3">3层</option>
                <option value="4">4层</option>
                <option value="5">5层</option>
                <option value="6">6层</option>
            </select>
            <br> <!-- 添加换行 -->
            <label for="status">是否通过：</label>
            <select id="status">
                <option value="pass">通过</option>
                <option value="fail">未通过</option>
            </select>
        </div>

        <!-- 第二部分：关卡分和结局分 -->
        <div class="section">
            <h2>关卡分和结局分</h2>
            <label for="normalMission">普通作战次数：</label><br>
            <input type="number" id="normalMission" placeholder="输入次数"><br>

            <label for="emergencyMission">紧急作战次数：</label><br>
            <input type="number" id="emergencyMission" placeholder="输入次数"><br>

            <label for="unexpectedMission">不期而遇作战次数：</label><br>
            <input type="number" id="unexpectedMission" placeholder="输入次数"><br>

            <label for="ending">选择结局：</label><br>
            <select id="endingSelect">
                <option value="50">卢西恩 · 猩红血钻 </option>
                <option value="180">伤心的大锁 </option>
                <option value="100">剧团喉舌 </option>
                <option value="120">剧作家 </option>
            </select><br>
            <button onclick="addEnding()">添加结局</button>
            <div id="endingList"></div>
        </div>

        <!-- 第三部分：临时干员招募得分 -->
        <div class="section">
            <h2>干员招募临时得分</h2>
            <label for="sixStarRecruit">6星干员招募次数：</label>
            <input type="number" id="sixStarRecruit" placeholder="输入次数"><br>

            <label for="fiveStarRecruit">5星干员招募次数：</label>
            <input type="number" id="fiveStarRecruit" placeholder="输入次数"><br>

            <label for="fourStarRecruit">4星干员招募次数：</label>
            <input type="number" id="fourStarRecruit" placeholder="输入次数"><br>

            <label for="xpSixStarRecruit">6星XP干员次数：</label>
            <input type="number" id="xpSixStarRecruit" placeholder="输入次数"><br>

            <label for="xpFiveStarRecruit">5星XP干员次数：</label>
            <input type="number" id="xpFiveStarRecruit" placeholder="输入次数"><br>
        </div>

        <!-- 第四部分：其他得分 -->
        <div class="section">
            <h2>其他得分</h2>
            <label for="collections">藏品数量：</label>
            <input type="number" id="collections" placeholder="输入藏品数量"><br>

            <label for="bossKill">鸭熊击杀：</label>
            <input type="number" id="bossKill" placeholder="输入击杀次数"><br>
        </div>

        <button onclick="calculate()">计算总分</button>

        <div id="result"></div>
        <div id="details"></div>
    </div>

    <script>
        let endings = [];

        function addEnding() {
            const endingSelect = document.getElementById('endingSelect');
            const selectedEndingText = endingSelect.options[endingSelect.selectedIndex].text;
            const selectedEndingValue = endingSelect.value;

            const selectedEnding = `${selectedEndingText} (${selectedEndingValue}分)`;

            // 添加结局到列表
            endings.push({ text: selectedEndingText, value: parseInt(selectedEndingValue) });

            // 显示所有选中的结局
            let endingListText = endings.map(ending => `${ending.text} +${ending.value}分`).join(', ');
            document.getElementById('endingList').innerText = endingListText;
        }

        function calculate() {
            let details = '';

        // 第一部分得分：通过层数分，累加得分
        const floor = parseInt(document.getElementById('floor').value);
        const status = document.getElementById('status').value;
        let floorScore = 0;
        let floorDetail = '';
        
        // 累加前面所有已通过的层数得分
        if (floor >= 1) floorScore += 50;  // 第1层
        if (floor >= 2) floorScore += 100; // 第2层
        if (floor >= 3) floorScore += 100; // 第3层
        if (floor >= 4) floorScore += 150; // 第4层
        if (floor >= 5) floorScore += 150; // 第5层
        if (floor === 6) floorScore += 150; // 第6层
        
        // 处理未通过的情况：当前层得一半，前面层得全额
        if (status === 'fail') {
            let currentLayerScore = 0;
        
            // 确定当前层的分数
            if (floor === 1) currentLayerScore = 50;
            else if (floor === 2) currentLayerScore = 100;
            else if (floor === 3) currentLayerScore = 100;
            else if (floor === 4) currentLayerScore = 150;
            else if (floor === 5) currentLayerScore = 150;
            else if (floor === 6) currentLayerScore = 150;
        
            // 只给当前层一半分数
            floorScore -= currentLayerScore / 2;
            floorDetail = `到达第${floor}层 +${currentLayerScore / 2}分（前${floor - 1}层 +${floorScore}分）`;
        
        } else {
            // 如果通过，则直接输出全额得分
            floorDetail = `通过第${floor}层 +${floorScore}分`;
        }
        
        // 输出得分详情
        details += floorDetail + '<br>';


            // 第二部分得分：关卡分和结局分
            const normalMission = parseInt(document.getElementById('normalMission').value) || 0;
            const emergencyMission = parseInt(document.getElementById('emergencyMission').value) || 0;
            const unexpectedMission = parseInt(document.getElementById('unexpectedMission').value) || 0;
            const missionScore = (normalMission * 10) + (emergencyMission * 20) + (unexpectedMission * 20);

            details += `普通作战 ${normalMission} 次 +${normalMission * 10}分<br>`;
            details += `紧急作战 ${emergencyMission} 次 +${emergencyMission * 20}分<br>`;
            details += `不期而遇作战 ${unexpectedMission} 次 +${unexpectedMission * 20}分<br>`;

            let endingScore = 0;
            if (endings.length > 0) {
                details += `结局: ${endings.map(ending => `${ending.text} +${ending.value}分`).join(', ')}<br>`;
                endings.forEach(ending => {
                    endingScore += ending.value;
                });
            }


            // 第三部分得分：干员招募得分
            const sixStarRecruit = parseInt(document.getElementById('sixStarRecruit').value) || 0;
            const fiveStarRecruit = parseInt(document.getElementById('fiveStarRecruit').value) || 0;
            const fourStarRecruit = parseInt(document.getElementById('fourStarRecruit').value) || 0;
            const xpSixStarRecruit = parseInt(document.getElementById('xpSixStarRecruit').value) || 0;
            const xpFiveStarRecruit = parseInt(document.getElementById('xpFiveStarRecruit').value) || 0;

            const recruitScore = (sixStarRecruit * 30) + (fiveStarRecruit * 20) + (fourStarRecruit * 10) + (xpSixStarRecruit * 60) + (xpFiveStarRecruit * 30);

            details += `6星干员招募 ${sixStarRecruit} 次 +${sixStarRecruit * 30}分<br>`;
            details += `5星干员招募 ${fiveStarRecruit} 次 +${fiveStarRecruit * 20}分<br>`;
            details += `4星干员招募 ${fourStarRecruit} 次 +${fourStarRecruit * 10}分<br>`;
            details += `6星XP干员 ${xpSixStarRecruit} 次 +${xpSixStarRecruit * 60}分<br>`;
            details += `5星XP干员 ${xpFiveStarRecruit} 次 +${xpFiveStarRecruit * 30}分<br>`;

            // 第四部分得分：其他得分
            const collections = parseInt(document.getElementById('collections').value) || 0;
            const bossKill = parseInt(document.getElementById('bossKill').value) || 0;
            const otherScore = (collections * 10) + (bossKill * 20);

            details += `藏品 ${collections} 件 +${collections * 10}分<br>`;
            details += `鸭爵/高普尼克击杀 ${bossKill} 次 +${bossKill * 20}分<br>`;

            // 总得分
            const totalScore = floorScore + missionScore + endingScore + recruitScore + otherScore;

            document.getElementById('result').innerText = "总得分: " + totalScore;
            document.getElementById('details').innerHTML = details;
        }
    </script>
</body>
</html>
